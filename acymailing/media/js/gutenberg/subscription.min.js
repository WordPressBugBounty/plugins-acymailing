const acym_subscriptionBlock={el:"",useBlockProps:"",blockEditor:"",components:"",wpElement:"",ajaxUrl:"admin-ajax.php?action=acymailing_router&noheader=1",lists:[],fields:[],posts:[],listPlacement:[],displayMode:[],displayTextMode:[],unsubButton:[],replaceMessage:[],subscriberInfo:[],alignment:[],includeJavascript:[],styleMultiselect:{minHeight:"90px"},init:function(t,e,i,l){this.initValues(),this.initLists(),this.initFields(),this.initPosts(),this.wpElement=e,this.el=this.wpElement.createElement,this.useBlockProps=i.useBlockProps,this.blockEditor=i,this.components=l,this.registerBlock(t),this.initCategory(t)},initValues:function(){this.listPlacement=[{value:"before",label:ACYM_JS_TXT.ACYM_BEFORE_FIELDS},{value:"after",label:ACYM_JS_TXT.ACYM_AFTER_FIELDS}],this.displayMode=[{value:"inline",label:ACYM_JS_TXT.ACYM_MODE_HORIZONTAL},{value:"vertical",label:ACYM_JS_TXT.ACYM_MODE_VERTICAL},{value:"tableless",label:ACYM_JS_TXT.ACYM_MODE_TABLELESS}],this.displayTextMode=[{value:"1",label:ACYM_JS_TXT.ACYM_TEXT_INSIDE},{value:"0",label:ACYM_JS_TXT.ACYM_TEXT_OUTSIDE}],this.unsubButton=[{value:"0",label:ACYM_JS_TXT.ACYM_NO},{value:"1",label:ACYM_JS_TXT.ACYM_CONNECTED_USER_SUBSCRIBED},{value:"2",label:ACYM_JS_TXT.ACYM_ALWAYS}],this.replaceMessage=[{value:"replace",label:ACYM_JS_TXT.ACYM_SUCCESS_REPLACE},{value:"replacetemp",label:ACYM_JS_TXT.ACYM_SUCCESS_REPLACE_TEMP},{value:"toptemp",label:ACYM_JS_TXT.ACYM_SUCCESS_TOP_TEMP},{value:"standard",label:ACYM_JS_TXT.ACYM_SUCCESS_STANDARD}],this.subscriberInfo=[{value:"1",label:ACYM_JS_TXT.ACYM_YES},{value:"0",label:ACYM_JS_TXT.ACYM_NO}],this.alignment=[{value:"none",label:ACYM_JS_TXT.ACYM_DEFAULT},{value:"left",label:ACYM_JS_TXT.ACYM_LEFT},{value:"center",label:ACYM_JS_TXT.ACYM_CENTER},{value:"right",label:ACYM_JS_TXT.ACYM_RIGHT}],this.includeJavascript=[{value:"header",label:ACYM_JS_TXT.ACYM_IN_HEADER},{value:"module",label:ACYM_JS_TXT.ACYM_ON_THE_MODULE}]},initLists:function(){for(let[t,e]of Object.entries(acym_lists))this.lists.push({value:t,label:e})},initFields:function(){for(let[t,e]of Object.entries(acym_fields))this.fields.push({value:t,label:e.name})},initPosts:function(){jQuery.get(this.ajaxUrl,{ctrl:"dynamics",task:"trigger",plugin:"plgAcymPost",trigger:"getPosts"}).then(t=>{const e=JSON.parse(t);this.posts=[{value:"",label:ACYM_JS_TXT.ACYM_SELECT_A_PAGE}],e.map(t=>{this.posts.push({value:t[0],label:t[1]})})})},registerBlock:function(t){const e=this.el("span",{class:"dashicon dashicons dashicons-email",style:{color:"#2199e8"}});t.registerBlockType("acymailing/subscription-form",{apiVersion:2,title:ACYM_JS_TXT.ACYM_ACYMAILING_SUBSCRIPTION_FORM,icon:e,category:"acymailing",edit:this.edit})},edit:function(t){let e=acym_subscriptionBlock.useBlockProps(),i=acym_subscriptionBlock,{Fragment:l}=i.wpElement,{PanelBody:_}=i.components,{InspectorControls:s}=i.blockEditor;const T=Object.keys(t.attributes).join().match(/(subtext_[a-z]{2,3}-[a-z]{2,3})/gim),a=Object.keys(t.attributes).join().match(/(subtextlogged_[a-z]{2,3}-[a-z]{2,3})/gim),n=Object.keys(t.attributes).join().match(/(confirmation_message_[a-z]{2,3}-[a-z]{2,3})/gim);let C=[],M=[];if(null!=T){let e="";T.forEach(l=>{e=l.replace("subtext_",""),C.push(i.textEdit(`${ACYM_JS_TXT.ACYM_SUBSCRIBE_TEXT} ${e}`,t,l))}),a.forEach(l=>{e=l.replace("subtextlogged_",""),C.push(i.textEdit(`${ACYM_JS_TXT.ACYM_SUBSCRIBE_TEXT_LOGGED_IN} ${e}`,t,l))}),n.forEach(l=>{e=l.replace("confirmation_message_",""),M.push(i.textEdit(`${ACYM_JS_TXT.ACYM_CONFIRMATION_MESSAGE} ${e}`,t,l))})}else C.push(i.textEdit(ACYM_JS_TXT.ACYM_SUBSCRIBE_TEXT,t,"subtext")),C.push(i.textEdit(ACYM_JS_TXT.ACYM_SUBSCRIBE_TEXT_LOGGED_IN,t,"subtextlogged")),M.push(i.textEdit(ACYM_JS_TXT.ACYM_CONFIRMATION_MESSAGE,t,"confirmation_message"));return i.el("div",e,i.el(l,{},i.el(s,{},i.el(_,{title:ACYM_JS_TXT.ACYM_MAIN_OPTIONS,initialOpen:!0},i.textEdit(ACYM_JS_TXT.ACYM_TITLE,t,"title"),i.selectEdit(ACYM_JS_TXT.ACYM_DISPLAY_MODE,t,"mode","displayMode"),...C),i.el(_,{title:ACYM_JS_TXT.ACYM_LISTS_OPTIONS,initialOpen:!0},i.selectEdit(ACYM_JS_TXT.ACYM_AUTO_SUBSCRIBE_TO,t,"hiddenlists","lists",!0),i.selectEdit(ACYM_JS_TXT.ACYM_DISPLAYED_LISTS,t,"displists","lists",!0),i.selectEdit(ACYM_JS_TXT.ACYM_LISTS_CHECKED_DEFAULT,t,"listschecked","lists",!0),i.selectEdit(ACYM_JS_TXT.ACYM_DISPLAY_LISTS,t,"listposition","listPlacement")),i.el(_,{title:ACYM_JS_TXT.ACYM_FIELDS_OPTIONS,initialOpen:!1},i.selectEdit(ACYM_JS_TXT.ACYM_FIELDS_TO_DISPLAY,t,"fields","fields",!0),i.selectEdit(ACYM_JS_TXT.ACYM_TEXT_MODE,t,"textmode","displayTextMode"),i.selectEdit(ACYM_JS_TXT.ACYM_FORM_AUTOFILL_ID,t,"userinfo","subscriberInfo")),i.el(_,{title:ACYM_JS_TXT.ACYM_TERMS_POLICY_OPTIONS,initialOpen:!1},i.selectEdit(ACYM_JS_TXT.ACYM_TERMS_CONDITIONS,t,"termscontent","posts"),i.textEdit(ACYM_JS_TXT.ACYM_TERMS_CONDITIONS_URL,t,"termscontentURL"),i.selectEdit(ACYM_JS_TXT.ACYM_PRIVACY_POLICY,t,"privacypolicy","posts"),i.textEdit(ACYM_JS_TXT.ACYM_PRIVACY_POLICY_URL,t,"privacypolicyURL")),i.el(_,{title:ACYM_JS_TXT.ACYM_SUBSCRIBE_OPTIONS,initialOpen:!1},i.selectEdit(ACYM_JS_TXT.ACYM_SUCCESS_MODE,t,"successmode","replaceMessage"),...M,i.textEdit(ACYM_JS_TXT.ACYM_REDIRECT_LINK,t,"redirect")),i.el(_,{title:ACYM_JS_TXT.ACYM_UNSUBSCRIBE_OPTIONS,initialOpen:!1},i.selectEdit(ACYM_JS_TXT.ACYM_DISPLAY_UNSUB_BUTTON,t,"unsub","unsubButton"),i.textEdit(ACYM_JS_TXT.ACYM_UNSUBSCRIBE_TEXT,t,"unsubtext"),i.textEdit(ACYM_JS_TXT.ACYM_REDIRECT_LINK_UNSUB,t,"unsubredirect")),i.el(_,{title:ACYM_JS_TXT.ACYM_ADVANCED_OPTIONS,initialOpen:!1},i.textEdit(ACYM_JS_TXT.ACYM_INTRO_TEXT,t,"introtext"),i.textEdit(ACYM_JS_TXT.ACYM_POST_TEXT,t,"posttext"),i.selectEdit(ACYM_JS_TXT.ACYM_ALIGNMENT,t,"alignment","alignment"),i.selectEdit(ACYM_JS_TXT.ACYM_MODULE_JS,t,"includejs","includeJavascript"),i.textEdit(ACYM_JS_TXT.ACYM_SOURCE,t,"source")))),i.el(window.wp.serverSideRender,{block:"acymailing/subscription-form",attributes:t.attributes}))},textEdit:function(t,e,i,l={width:"100%"}){let{TextControl:_}=this.components;return this.el(_,{label:t,onChange:t=>{let l={};l[i]=t,e.setAttributes(l)},value:e.attributes[i],style:l})},selectEdit:function(t,e,i,l,_=!1,s={}){let{SelectControl:T}=this.components;return _&&(s=this.styleMultiselect),this.el(T,{multiple:_,label:t,onChange:t=>{let l={};l[i]=t,e.setAttributes(l)},style:s,value:e.attributes[i],options:this[l]})},initCategory:function(t){const e=this.el("svg",{width:20,height:20,viewBox:"0 0 1024 1024"},this.el("path",{d:"M553.074 174.168c-12.201 7.319-26.84 10.573-40.668 10.573s-27.655-3.253-40.668-10.573l-242.376-139.081-229.362 132.575v732.011l254.576 143.963v-430.26l219.602 124.442c11.388 6.507 24.401 9.76 37.415 9.76 0 0 0 0 0 0s0 0 0 0c12.201 0 25.214-3.253 36.6-9.76l221.23-124.442v430.26l254.576-144.775v-732.011l-229.362-131.762-241.563 139.081zM491.261 701.215l-217.164-122.815-61.001-34.161v430.26l-173.243-97.601v-662.063l422.94 245.629c0 0 0 0 0 0 8.947 4.881 17.895 8.135 27.655 10.573v230.178zM983.334 876.086l-173.243 98.416v-431.073l-61.001 34.161-217.164 122.815v-229.362c9.76-2.441 18.707-5.694 27.655-10.573l423.753-246.444v662.063zM539.246 425.493c-17.080 9.76-38.227 9.76-55.307 0 0 0 0 0 0 0l-422.94-245.629 168.362-97.601 222.043 127.696c18.707 10.573 39.853 16.267 61.001 16.267s42.294-5.694 61.001-16.267l222.043-127.696 168.362 97.601-424.566 245.629z",fill:"#2199e8"}));t.updateCategory("acymailing",{icon:e})}};window.addEventListener("DOMContentLoaded",()=>{acym_subscriptionBlock.init(window.wp.blocks,window.wp.element,window.wp.blockEditor,window.wp.components)});