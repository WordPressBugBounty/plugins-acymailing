jQuery(function(a){a("#launch_spamtest").off("click").on("click",function(){if(a(this).hasClass("disabled"))return!1;a(this).addClass("disabled"),a(".acym_icon_container").find('i:not(".acymicon-question-circle-o")').removeClass().html("").addClass("acymicon-circle-o-notch acymicon-spin"),a(".acym_check_results").hide().html(""),a("#acym_spam_test_details").addClass("is-hidden"),a("#safe_check_results").removeClass("is-hidden"),c("Content","check_words","checkContent"),c("Links","check_links","checkLinks"),a("#check_spam").find("i").hasClass("acymicon-question-circle-o")?a(".acym__campaigns__test__pro").toggle():c("SPAM","check_spam","checkSPAM")}),a("#acym_spam_test_details button").off("click").on("click",function(){a("#check_spam").trigger("click")}),a("#acym__campaign__send-test").off("click").on("click",function(){a("#acym__campaigns__send-test__spinner").show();const e=a(this);e.attr("disabled","true");const c=a("#mail_id_test");let s=0;c.length&&(s=c.val());const t=ACYM_AJAX_URL+"&page=acymailing_campaigns&ctrl=campaigns&task=test&campaignId="+a('input[name="campaignId"]').val()+"&mailId="+s+"&test_note="+encodeURIComponent(jQuery("#acym__wysid__send__test__note").val())+"&test_emails="+encodeURIComponent(a(".acym__multiselect__email").val().join(","));a.post(t,function(c){e.removeAttr("disabled"),a("#acym__campaigns__send-test__spinner").hide(),c=acym_helper.parseJson(c),acym_helperNotification.addNotification(c.message,c.error?"error":"info")})});let e=0;function c(c,s,t){const i=a("#mail_id_test");let n=0;i.length&&(n=i.val());const l=a('input[name="campaignId"]').val(),_=a("#"+s).removeClass("acym_clickable").off("click"),m=_.find(".acym_icon_container i");acym_helper.get(`${ACYM_AJAX_URL}&ctrl=campaigns&task=${t}&campaignId=${l}&mailId=${n}`).then(s=>{if("SPAM"===c)if(s.error)_.next(".acym_check_results").html(s.message),_.addClass("acym_clickable").on("click",function(){a(this).next(".acym_check_results").slideToggle()}),m.removeClass().addClass("acymicon-exclamation-circle acym_icon_red");else{_.next(".acym_check_results").html(ACYM_JS_TXT.ACYM_TESTS_SPAM_SENT).show();let e=0,c=setInterval(function(){e++,acym_helper.get(s.data.url+"&format=json").then(t=>{!1!==t.status?(clearInterval(c),_.next(".acym_check_results").hide(),a("#acym_spam_test_details").removeClass("is-hidden"),t.mark>-2?m.removeClass().addClass("acymicon-check-circle acym_icon_green"):m.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),_.attr("data-open")||_.attr("data-open",_.attr("data-iframe")),_.addClass("acym_clickable").attr("data-iframe",s.data.url+"&lang="+s.data.lang),acym_helperModal.initModal()):e>5&&(_.next(".acym_check_results").html(t.title),_.addClass("acym_clickable").on("click",function(){a(this).next(".acym_check_results").slideToggle()}),m.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),clearInterval(c))})},1e4)}else s.data.result.length>0?(m.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),_.addClass("acym_clickable").on("click",function(){a(this).next(".acym_check_results").slideToggle()}),_.next(".acym_check_results").html(s.data.result)):m.removeClass().addClass("acymicon-check-circle acym_icon_green");3===++e&&(e=0,a("#launch_spamtest").removeClass("disabled"))})}});